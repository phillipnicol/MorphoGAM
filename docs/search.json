[{"path":"https://phillipnicol.github.io/MorphoGAM/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Phillip B. Nicol. Maintainer.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Nicol PB, Ma R, Xu RJ, Moffitt JR, Irizarry RA (2024).     Identifying spatially variable genes projecting morphologically relevant curves.     bioRxiv. https://doi.org/10.1101/2024.01.31.578163","code":"@Article{,   title = {Identifying spatially variable genes by projecting to morphologically relevant curves},   author = {Phillip B Nicol and Rong Ma and Rosalind J Xu and Jeffrey R Moffitt and Rafael A Irizarry},   journal = {bioRxiv},   year = {2024},   note = {doi:10.1101/2024.01.31.578163}, }"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinder.html","id":null,"dir":"Reference","previous_headings":"","what":"CurveFinder: Automatically estimate curve in two-dimensional ST data — CurveFinder","title":"CurveFinder: Automatically estimate curve in two-dimensional ST data — CurveFinder","text":"function estimates (possibly closed) parametric curve passing spatial transcriptomics data uses curve define morphologically relevant coordinates `t` `r`.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CurveFinder: Automatically estimate curve in two-dimensional ST data — CurveFinder","text":"","code":"CurveFinder(xy, knn = 5, prune.outlier = NULL, loop = FALSE)"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CurveFinder: Automatically estimate curve in two-dimensional ST data — CurveFinder","text":"xy numeric matrix data frame two columns representing x y coordinates data points. knn integer specifying number nearest neighbors used construct KNN graph. Default 5. prune.outlier numeric threshold pruning outliers based distance k+1 nearest neighbor. Outliers removed distance exceeds `prune.outlier * median(nnk)`. Defaults NULL (pruning). loop logical value indicating whether curve treated loop (closed curve). Default FALSE.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinder.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"CurveFinder: Automatically estimate curve in two-dimensional ST data — CurveFinder","text":"list containing: xyt data frame x y coordinates, fitted curve parameters (`t` `r`), fitted values x y (`f1` abd `f2`). curve.plot ggplot object showing original data fitted curve overlaid. coordinate.plot ggplot object displaying data points color-coded fitted `t` values. residuals.plot ggplot object displaying data points color-coded fitted `r` values.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinder.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"CurveFinder: Automatically estimate curve in two-dimensional ST data — CurveFinder","text":"-","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinder.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"CurveFinder: Automatically estimate curve in two-dimensional ST data — CurveFinder","text":"Kraemer G, Reichstein M, Mahecha MD (2018). “dimRed coRanking—Unifying Dimensionality Reduction R.” _The R Journal_, *10*(1), 342-358.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinderInteractive.html","id":null,"dir":"Reference","previous_headings":"","what":"Interactively sketch and smooth a curve through 2D points — CurveFinderInteractive","title":"Interactively sketch and smooth a curve through 2D points — CurveFinderInteractive","text":"Launches small Shiny app can click points sketch polyline 2D data xy. press **Smooth**, clicked polyline smoothed mgcv used project data onto curve (via princurve), returning coordinates \\(t \\[0,1]\\) along curve residual-like coordinate \\(r\\) orthogonal .","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinderInteractive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interactively sketch and smooth a curve through 2D points — CurveFinderInteractive","text":"","code":"CurveFinderInteractive(xy, loop = FALSE)"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinderInteractive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interactively sketch and smooth a curve through 2D points — CurveFinderInteractive","text":"xy numeric matrix data.frame exactly two columns (interpreted x, y). Row order treated set points visualize/project. loop Logical; TRUE, smoothed curve uses cyclic basis (appropriate closed loops). FALSE, uses non-cyclic basis.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinderInteractive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interactively sketch and smooth a curve through 2D points — CurveFinderInteractive","text":"list elements produced interactiveCurve(): xyt: data.frame columns x, y,         t (curve coordinate scaled [0,1]),         r (orthogonal residual-like coordinate),         f1, f2 (fitted x(t) y(t) values). curve.plot: ggplot2 object showing data         smoothed curve colored t. coordinate.plot: ggplot2 scatter plot colored t. residuals.plot: ggplot2 scatter plot colored r.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/CurveFinderInteractive.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Interactively sketch and smooth a curve through 2D points — CurveFinderInteractive","text":"- Input xy must 2 columns corresponding x y. - Click least 3 points define path; use **Clear clicks** restart. - Smoothing uses mgcv::gam cyclic cubic spline (bs = \"cc\")   loop = TRUE, otherwise cubic regression spline (bs = \"cr\"). - smoothing, points projected smoothed curve using   princurve::project_to_curve, set outputs (including plots)   returned app closes.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/MorphoGAM.html","id":null,"dir":"Reference","previous_headings":"","what":"MorphoGAM: Apply a GAM to the morphologically relevant coordinates — MorphoGAM","title":"MorphoGAM: Apply a GAM to the morphologically relevant coordinates — MorphoGAM","text":"morphologically relevant coordinates can estimated using `CurveFinder()` `CurveFinderInteractive()`. function applies flexible count-based model identify genes spatially variable expression respect morphologically relevant coordinates. Estimate distance condition means gene expression space. DESCRIPTION","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/MorphoGAM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MorphoGAM: Apply a GAM to the morphologically relevant coordinates — MorphoGAM","text":"","code":"MorphoGAM(   Y,   curve.fit,   design,   shrinkage = FALSE,   min.count.per.gene = 10,   return.fx = TRUE,   offset = NULL,   knots.t = NULL,   knots.r = NULL )"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/MorphoGAM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MorphoGAM: Apply a GAM to the morphologically relevant coordinates — MorphoGAM","text":"Y numeric matrix rows represent genes columns represent samples (e.g., cells). curve.fit object produced `CurveFinder`, containing fitted curve parameters (`t` `r`) sample. design formula specifying GAM design, typically including smooth terms `t` `r` (e.g., `y ~ s(t) + s(r)`). shrinkage logical value indicating whether apply shrinkage smooth term coefficients using `ashr`. Default `TRUE`. min.count.per.gene integer specifying minimum total count required gene included analysis. Default 10. return.fx logical value indicating whether return fitted smooth terms `t` `r` gene. Default `TRUE`. offset numeric vector providing offset values GAM model. `NULL` (default), offsets computed logarithm column sums `Y`. knots.t Optional numeric vector specifying knot locations smooth term `t`. knots.r Optional numeric vector specifying knot locations smooth term `r`.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/MorphoGAM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MorphoGAM: Apply a GAM to the morphologically relevant coordinates — MorphoGAM","text":"list containing: results data frame rows corresponding genes following columns: peak.t Maximum absolute smooth term `t`. range.t Range predicted expression values along `t`. pv.t p-value smooth term `t`. peak.r Maximum absolute smooth term `r`. range.r Range predicted expression values along `r`. pv.r p-value smooth term `r`. intercept Intercept fitted model. `return.fx = TRUE`, list also includes: fxs.t matrix fitted smooth terms `t` (genes x samples). fxs.r matrix fitted smooth terms `r` (genes x samples).","code":""},{"path":[]},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/MorphoGAM.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"MorphoGAM: Apply a GAM to the morphologically relevant coordinates — MorphoGAM","text":"Phillip B. Nicol <philnicol740@gmail.com>","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/get_mapper_graph.html","id":null,"dir":"Reference","previous_headings":"","what":"Mapper Algorithm — get_mapper_graph","title":"Mapper Algorithm — get_mapper_graph","text":"See following article details: Singh, Gurjeet, Facundo Mémoli, Gunnar E. Carlsson. \"Topological methods analysis high dimensional data sets 3d object recognition.\" SPBG. 2007.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/get_mapper_graph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mapper Algorithm — get_mapper_graph","text":"","code":"get_mapper_graph(   graph,   filter_values,   num_intervals = 10,   percent_overlap = 33 )"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/get_mapper_graph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mapper Algorithm — get_mapper_graph","text":"graph igraph object (n vertices). filter_values numeric vector (n) filter values, specifying order vertices graph thus group level sets. num_intervals integer specifying resolution Mapper algorithm (number level sets). percent_overlap numeric 0 100 specifying gain Mapper algorithm (percentage level sets overlap).","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/get_mapper_graph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mapper Algorithm — get_mapper_graph","text":"igraph object containing Mapper graph","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/get_mapper_graph.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mapper Algorithm — get_mapper_graph","text":"","code":"my_data <- makeSwissRoll() #> Error in makeSwissRoll(): could not find function \"makeSwissRoll\" my_graph <- dimRed:::makeKNNgraph(x = my_data, k = 5, eps = 0) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'nrow': object 'my_data' not found mapper_graph <- get_mapper_graph(my_graph, my_data[, 1]) #> Error in get_mapper_graph(my_graph, my_data[, 1]): could not find function \"get_mapper_graph\" get_mapper_plot(my_data, mapper_graph) #> Error in get_mapper_plot(my_data, mapper_graph): could not find function \"get_mapper_plot\""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/hello.html","id":null,"dir":"Reference","previous_headings":"","what":"Hello, World! — hello","title":"Hello, World! — hello","text":"Prints 'Hello, world!'.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/hello.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hello, World! — hello","text":"","code":"hello()"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/hello.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hello, World! — hello","text":"","code":"hello() #> Error in hello(): could not find function \"hello\""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/is_loop.html","id":null,"dir":"Reference","previous_headings":"","what":"Determines if a k-nearest neighbors graph of a dataset forms a loop. — is_loop","title":"Determines if a k-nearest neighbors graph of a dataset forms a loop. — is_loop","text":"Loops detected large cycles output Mapper algorithm.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/is_loop.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determines if a k-nearest neighbors graph of a dataset forms a loop. — is_loop","text":"","code":"is_loop(xy, knn_graph)"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/is_loop.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determines if a k-nearest neighbors graph of a dataset forms a loop. — is_loop","text":"xy numeric matrix data frame two columns representing x y coordinates data points. knn_graph k-nearest neighbors graph `xy`.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/is_loop.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determines if a k-nearest neighbors graph of a dataset forms a loop. — is_loop","text":"Whether k-nearest neighbors graph loop.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/is_loop.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Determines if a k-nearest neighbors graph of a dataset forms a loop. — is_loop","text":"","code":"my_data <- makeSwissRoll() #> Error in makeSwissRoll(): could not find function \"makeSwissRoll\" my_graph <- dimRed:::makeKNNgraph(x = my_data, k = 5, eps = 0) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'nrow': object 'my_data' not found testthat::expect_false(is_loop(my_data, my_graph)) #> Error in is_loop(my_data, my_graph): could not find function \"is_loop\""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotFPCloading.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot top gene loadings from SVD Analysis — plotFPCloading","title":"Plot top gene loadings from SVD Analysis — plotFPCloading","text":"Visualize \\(L\\)-th FPCA eigenfunction together top num_genes genes strongly associated component, either t r coordinate.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotFPCloading.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot top gene loadings from SVD Analysis — plotFPCloading","text":"","code":"plotFPCloading(mgam_object, curve.fit, L = 1, num_genes = 5, type = \"t\")"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotFPCloading.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot top gene loadings from SVD Analysis — plotFPCloading","text":"mgam_object output MorphoGAM curve.fit output CurveFinder L Integer; index FPCA component. num_genes Integer; number top-loading genes display. type Character string; one \"t\" \"r\" specifying coordinate plot .","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotFPCloading.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot top gene loadings from SVD Analysis — plotFPCloading","text":"ggplot2 object showing lines eigenfunction   selected gene smooths. bright qualitative palette (excluding yellow)   used gene curves; labels placed near curve's maximum.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotFPCloading.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot top gene loadings from SVD Analysis — plotFPCloading","text":"function identifies num_genes genes largest absolute scores mgam_object$fpca.t. may flip sign improve visualization.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotGAMestimates.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot depth-normalized counts with fitted GAM overlay — plotGAMestimates","title":"Plot depth-normalized counts with fitted GAM overlay — plotGAMestimates","text":"set genes, plots depth-normalized counts across either coordinate t coordinate r, optional overlaid fitted function mixed GAM object.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotGAMestimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot depth-normalized counts with fitted GAM overlay — plotGAMestimates","text":"","code":"plotGAMestimates(   Y,   genes,   mgam_object,   curve_fit,   type = \"t\",   nrow = 1,   include.gam = TRUE )"},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotGAMestimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot depth-normalized counts with fitted GAM overlay — plotGAMestimates","text":"Y numeric matrix-like (e.g., matrix, Matrix::dgCMatrix) counts genes rows cells/samples columns. Row names include values provided genes. genes character vector (integer indices) gene identifiers plot. mgam_object output running MorphoGAM function. curve_fit output running CurveFinder (interactive version) function. type Character string; one \"t\" \"r\" specifying coordinate plot . nrow Integer; number rows facet layout. include.gam Logical; TRUE, overlay red GAM fit line.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotGAMestimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot depth-normalized counts with fitted GAM overlay — plotGAMestimates","text":"ggplot2 object showing depth-normalized counts gene   (facets) versus t r, optional fitted curve.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/reference/plotGAMestimates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot depth-normalized counts with fitted GAM overlay — plotGAMestimates","text":"Columns (cells/samples) depth-normalized dividing library size (column sum) multiplying median library size across columns. type = \"t\", x-axis uses curve_fit$xyt$t fitted values come mgam_object$fxs.t. type = \"r\", x-axis uses curve_fit$xyt$r fitted values come mgam_object$fxs.r. Fitted curves constructed \\(n_{med} \\cdot \\exp(\\beta_{g0} + f_g(x))\\), \\(\\beta_{g0}\\) gene-specific intercept \\(f_g(x)\\) smooth contribution gene.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/news/index.html","id":"version-100-december-19-2025","dir":"Changelog","previous_headings":"","what":"Version 1.0.0 December 19, 2025","title":"Version 1.0.0 December 19, 2025","text":"Initial release.","code":""},{"path":"https://phillipnicol.github.io/MorphoGAM/news/index.html","id":"version-110-october-13-2025","dir":"Changelog","previous_headings":"","what":"Version 1.1.0 October 13, 2025","title":"Version 1.1.0 October 13, 2025","text":"update adds new functionality well improving existing code. New functionality: Added functional PCA (based SVD) MorphoGAM() function. can visualized using plotFPCloading() . Added code CurveFinder() detect whether tissue structure open closed curve. Changes existing functionality: CurveFinderInteractive() completely rewritten. Option include known list knots, via knots.t MorphoGAM().","code":""}]
