% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/morphoGAM.R, R/zzz.R
\docType{package}
\name{MorphoGAM}
\alias{MorphoGAM-package}
\alias{MorphoGAM}
\title{MorphoGAM: Apply a GAM to the morphologically relevant coordinates}
\usage{
MorphoGAM(
  Y,
  curve.fit,
  design,
  shrinkage = FALSE,
  min.count.per.gene = 10,
  return.fx = TRUE,
  offset = NULL,
  knots.t = NULL,
  knots.r = NULL
)
}
\arguments{
\item{Y}{A numeric matrix where rows represent genes and columns represent samples (e.g., cells).}

\item{curve.fit}{An object produced by `CurveFinder`, containing the fitted curve parameters (`t` and `r`) for each sample.}

\item{design}{A formula specifying the GAM design, typically including smooth terms for `t` and `r` (e.g., `y ~ s(t) + s(r)`).}

\item{shrinkage}{A logical value indicating whether to apply shrinkage to smooth term coefficients using `ashr`. Default is `TRUE`.}

\item{min.count.per.gene}{An integer specifying the minimum total count required for a gene to be included in the analysis. Default is 10.}

\item{return.fx}{A logical value indicating whether to return the fitted smooth terms for `t` and `r` for each gene. Default is `TRUE`.}

\item{offset}{A numeric vector providing offset values for the GAM model. If `NULL` (default), offsets are computed as the logarithm of the column sums of `Y`.}
}
\value{
A list containing:
\item{results}{A data frame with rows corresponding to genes and the following columns:
\describe{
  \item{peak.t}{Maximum absolute smooth term for `t`.}
  \item{range.t}{Range of predicted expression values along `t`.}
  \item{pv.t}{p-value for the smooth term `t`.}
  \item{peak.r}{Maximum absolute smooth term for `r`.}
  \item{range.r}{Range of predicted expression values along `r`.}
  \item{pv.r}{p-value for the smooth term `r`.}
  \item{intercept}{Intercept of the fitted model.}
}}
If `return.fx = TRUE`, the list also includes:
\item{fxs.t}{A matrix of fitted smooth terms for `t` (genes x samples).}
\item{fxs.r}{A matrix of fitted smooth terms for `r` (genes x samples).}
}
\description{
The morphologically relevant coordinates can be estimated using
`CurveFinder()` or `CurveFinderInteractive()`. This function applies a flexible
count-based model to identify genes with spatially variable expression with
respect to the morphologically relevant coordinates.

Estimate the distance between
condition means in gene expression space.

DESCRIPTION
}
\author{
Phillip B. Nicol <philnicol740@gmail.com>
}
