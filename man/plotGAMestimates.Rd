% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotting.R
\name{plotGAMestimates}
\alias{plotGAMestimates}
\title{Plot depth-normalized counts with fitted GAM overlay}
\usage{
plotGAMestimates(
  Y,
  genes,
  mgam_object,
  curve_fit,
  type = "t",
  nrow = 1,
  include.gam = TRUE
)
}
\arguments{
\item{Y}{A numeric matrix-like (e.g., \code{matrix}, \code{Matrix::dgCMatrix})
of counts with \strong{genes in rows} and \strong{cells/samples in columns}.
Row names should include the values provided in \code{genes}.}

\item{genes}{A character vector (or integer indices) of gene identifiers to plot.}

\item{mgam_object}{The output from running the \code{MorphoGAM} function.}

\item{curve_fit}{The output from running the \code{CurveFinder} (or interactive version) function.}

\item{type}{Character string; one of \code{"t"} or \code{"r"} specifying which
coordinate to plot against.}

\item{nrow}{Integer; number of rows in the facet layout.}

\item{include.gam}{Logical; if \code{TRUE}, overlay the red GAM fit line.}
}
\value{
A \code{ggplot2} object showing depth-normalized counts for each gene
  (facets) versus \code{t} or \code{r}, with an optional fitted curve.
}
\description{
For a set of \code{genes}, this plots depth-normalized counts across either
the coordinate \code{t} or the coordinate \code{r}, with an
optional overlaid fitted function from a mixed GAM object.
}
\details{
Columns (cells/samples) are depth-normalized by dividing by the library size
(column sum) and multiplying by the median library size across all columns.
If \code{type = "t"}, the x-axis uses \code{curve_fit$xyt$t} and fitted
values come from \code{mgam_object$fxs.t}. If \code{type = "r"}, the x-axis
uses \code{curve_fit$xyt$r} and fitted values come from \code{mgam_object$fxs.r}.
Fitted curves are constructed as \eqn{n_{med} \cdot \exp(\beta_{g0} + f_g(x))},
where \eqn{\beta_{g0}} is the gene-specific intercept and \eqn{f_g(x)} is the
smooth contribution for that gene.
}
